# Prompt: Watch Image Normalize with Safe Area

## 목적
시계 상품 카드 UI에서
- 이미지가 작아지거나
- 잘리거나
- 두 장처럼 보이거나
- 배경이 어색하게 분리되는 문제를 방지하기 위해

"Safe Area(안전 영역)" 개념을 적용한
이미지 정규화 스크립트를 생성한다.

---

## 문제 정의 (중요 맥락)
- 브랜드별 원본 이미지 크기/비율이 다르다
- 오메가/튜더/롤렉스 이미지의 배경 높이가 다르다
- 이미지를 중앙에 맞추면 시계가 너무 작아질 수 있다
- 이미지를 확대하면 베젤/러그가 잘릴 수 있다

따라서 **시계 전체를 100% 보존하면서**
UI 카드에 최적화된 비율로 정렬해야 한다.

---

## Safe Area 정의
- 시계 본체 전체(베젤, 러그, 크라운 포함)가
  반드시 포함되어야 하는 영역
- Safe Area는 이미지의 80~85% 영역을 차지하도록 설정
- Safe Area 바깥은 padding(여백)으로 처리 가능

---

## 입력 / 출력
- input_dir: input/
- output_dir: /metadate

파일명 규칙:
- ref 기반 파일명 유지 (예: M79930-0007.jpg)

---

## 요구사항 (필수)

1. input_dir 내 jpg/png 파일 전체 순회
2. 이미지 비율과 해상도와 무관하게 처리
3. 시계 본체를 추정하여 bounding box 계산
   - OpenCV 사용 가능
   - 설치되지 않은 경우 fallback 로직 포함
4. bounding box를 기준으로 Safe Area 생성
5. Safe Area를 기준으로 정사각 캔버스 생성
6. 시계가 중앙에 오도록 정렬
7. 배경색은 단일 색상으로 통일 (예: #111 또는 #f5f5f5)
8. 시계 본체는 절대 잘리지 않아야 함
9. 결과 이미지는 카드 UI에서:
   - 너무 작아 보이지 않고
   - 배경이 두 장처럼 보이지 않아야 함

---

## 구현 힌트 (Cursor 참고용)
- bounding box 대비 1.15~1.25 배 확장하여 safe padding 확보
- 최종 캔버스는 정사각 (예: max(width, height))
- resize는 최종 단계에서만 수행
- 검은 배경이 포함된 원본도 고려

---

## Cursor에게 전달할 실제 프롬프트
---
너는 상품 이미지 정규화 경험이 많은 Python 엔지니어다.

위 요구사항을 만족하는
Python 스크립트를 작성하라.

조건:
- OpenCV 사용 가능
- OpenCV가 없을 경우 PIL 기반 fallback 포함
- 처리 로그를 콘솔에 출력
- 실패 파일은 WARN 로그로 표시

결과:
- metadata 폴더에 저장
- 원본은 절대 수정하지 않는다
---
